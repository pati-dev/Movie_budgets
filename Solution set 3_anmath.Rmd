---
title: "Solution set 3"
author: "Ankit Mathur"
date: "2/17/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, tidy = TRUE)
library(tidyverse)
library(GGally)
cb_palette = c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
```

# Solution 1

Load the data
```{r}
movies = read.csv("movie_budgets.txt", sep = " ")
```

Transform movie budgets to log scale
```{r}
movies$log_budget <- log10(movies$budget)
```

Plot *ggpairs* for all 3 vars
```{r}
ggpairs(movies, columns = c("log_budget", "length", "year"))
```

Takeaways:
  - Movie lengths and budgets seem to be correlated and *might be* following a linear relationship.
  - Maximum values of movie budgets seem to be increasing with year
  - Most of the movies in the dataset are ~90 minutes long and were released in the year 2000.
  - Interaction between year and length is not clear.

Color trivariate plots by year
```{r}
# unique(movies[order(movies$year), "year"])
# names(movies)
fac_year = rep(NA, nrow(movies))
fac_year[movies$year < 1960] = "1906-1960"
# fac_year[movies$year >= 1930 & movies$year < 1960] = "1930-1960"
# fac_year[movies$year >= 1960 & movies$year < 1990] = "1960-1990"
fac_year[movies$year >= 1960] = "1960-2005"
movies2 = data.frame(movies, fac_year)
ggpairs(movies2, columns = c("log_budget", "length", "year"), aes(color = fac_year))
```

Takeaways (first plot in the middle row):
  - Older movies (prior to 1960) have a much lesser variance in their lengths as compared to the newer movies (post 1960).
  - Older movies did not have as high budgets as the newer ones.

Plot movie budgets against their lengths faceted by year
```{r}
ggplot(movies2, aes(x = length, y = log_budget)) + geom_point() +
  geom_smooth(method = "loess", span = 1, method.args = list(degree = 1)) +
  facet_wrap(~ cut_number(year, n = 4), ncol = 2) +
  labs(title = "Movie budgets vs. lengths cut by year")
```

